## kafka组成
- 是基于发布/订阅（客户端拉取的）消息队列
- 由broker，producer，consumer组成
- 具有解耦，削峰等主要作用

## broker分区副本
- topic分区个数没有上限，支持添加不支持删除
- 副本小于等于broker数量
- 分区内消息是有序的
- 一个分区只能被一个消费者组中的消费者消费
- 存储(.log,.index文件)文件名都是数据中的最小的offset,且都是一一对应的，如000000.log,000000.index。index文件中的数据都是定长的。就像数组一样可以精确定位（内容为log文件的文件偏移量）。


## 生产者
- isr策略（选取与主分区更新时间最接近的副本，加入到isr队列中）
- 当isr中的所有副本消息都写入时，消息才是真的写入
- 高水位是isr中最后一条消息(isr中消息最少的副本中的最后一条数据，这是消费者能看到的最大数据。当发生主从切换时，以此为最新数据。比这个多的分区进行截取，来保证消息一致性)
- 最多写入一次（只等待主分区写入）
- 至少写一次（isr中的所有都写入）


## 消费者
- 消费组内实际的消费者个数小于等于分区数
- 当消费者数量发生变化时，触发消费者平衡策略
- 消费者数量=分区数，消费能力达到最大

## 冲突 

中途
中途


